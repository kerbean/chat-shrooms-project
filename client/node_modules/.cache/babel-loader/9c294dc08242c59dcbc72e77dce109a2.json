{"ast":null,"code":"import _classCallCheck from \"/Users/helengrace.delrosario/Desktop/BOOTCAMP/ACTIVITIES/WEEK23/PROJECT 3/Unsolved/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/helengrace.delrosario/Desktop/BOOTCAMP/ACTIVITIES/WEEK23/PROJECT 3/Unsolved/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/helengrace.delrosario/Desktop/BOOTCAMP/ACTIVITIES/WEEK23/PROJECT 3/Unsolved/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/helengrace.delrosario/Desktop/BOOTCAMP/ACTIVITIES/WEEK23/PROJECT 3/Unsolved/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/helengrace.delrosario/Desktop/BOOTCAMP/ACTIVITIES/WEEK23/PROJECT 3/Unsolved/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/helengrace.delrosario/Desktop/BOOTCAMP/ACTIVITIES/WEEK23/PROJECT 3/Unsolved/client/src/components/Main/Main.js\";\nimport React, { Component } from 'react'; //import logo from '../../images/logo.svg';\n\nimport './Main.css';\nimport Form from '../Form/Form';\nimport App from '../App/App';\nimport Nickname from \"../Nickname/Nickname\";\nimport Footer from \"../Footer\";\nimport firebase from 'firebase';\nimport firebaseConfig from '../../config';\nimport axios from 'axios';\nimport dotenv from 'dotenv';\nimport { BrowserRouter as Router, Route, Redirect } from 'react-router-dom';\nfirebase.initializeApp(firebaseConfig);\n\nvar Main =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Main, _Component);\n\n  function Main(props) {\n    var _this;\n\n    _classCallCheck(this, Main);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Main).call(this, props));\n\n    _this.nickCb = function (dataFromChild) {\n      _this.setState({\n        callback: dataFromChild\n      });\n    };\n\n    _this.state = {\n      user: null,\n      category: null,\n      exists: null,\n      current: null,\n      callback: null\n    };\n    return _this;\n  }\n\n  _createClass(Main, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      firebase.auth().onAuthStateChanged(function (user) {\n        _this2.setState({\n          user: user\n        });\n\n        _this2.doesUserExist(); // this.props.history.push('/path');\n\n      });\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      // console.log(this.state.exists.nickname);\n      // console.log(this.state.user.nickname)\n      console.log(\"Component Did Update!\");\n\n      if (this.state.exists && this.state.current) {\n        if (this.state.exists.nickname != this.state.current.nickname) {\n          console.log(\"REEEEE: \" + this.state.exists.nickname);\n          console.log(\"REEEEE: \" + this.state.user.nickname);\n          this.axiosUserExist();\n        }\n      }\n    }\n  }, {\n    key: \"axiosUserExist\",\n    value: function axiosUserExist() {\n      var _this3 = this;\n\n      axios.get('/api/email/' //+ 'test1@gmail.com') \n      + this.state.user.email).then(function (res) {\n        var users = res.data;\n        console.log(\"success + \" + users);\n\n        _this3.setState({\n          current: users\n        });\n      });\n    }\n  }, {\n    key: \"handleSignIn\",\n    value: function handleSignIn() {\n      var provider = new firebase.auth.GoogleAuthProvider();\n      firebase.auth().signInWithPopup(provider);\n    } // renderRedirect = () => {\n    //     return <Redirect to=\"/App\" />\n    // }\n\n  }, {\n    key: \"handleLogOut\",\n    value: function handleLogOut() {\n      firebase.auth().signOut();\n    }\n  }, {\n    key: \"chooseCategory1\",\n    value: function chooseCategory1() {\n      this.setState({\n        category: \"random\"\n      });\n    }\n  }, {\n    key: \"chooseCategory2\",\n    value: function chooseCategory2() {\n      this.setState({\n        category: \"disney\"\n      });\n    }\n  }, {\n    key: \"chooseCategory3\",\n    value: function chooseCategory3() {\n      this.setState({\n        category: \"tvseries\"\n      });\n    }\n  }, {\n    key: \"chooseCategory4\",\n    value: function chooseCategory4() {\n      this.setState({\n        category: \"games\"\n      });\n    }\n  }, {\n    key: \"doesUserExist\",\n    value: function doesUserExist() {\n      var _this4 = this;\n\n      console.log(\"doesUserExist - START\");\n      axios.get('/api/email/' //+ 'test1@gmail.com') \n      + this.state.user.email).then(function (res) {\n        var persons = res.data;\n        console.log(\"success + \" + persons);\n\n        _this4.setState({\n          exists: persons\n        });\n\n        if (!persons) {\n          var body = {\n            email: _this4.state.user.email,\n            nickname: _this4.state.user.displayName\n          };\n          console.log(\"Body: \" + JSON.stringify(body));\n          axios.post('/api/createUser', body);\n        }\n\n        console.log(\"Exists: \" + _this4.state.exists);\n      }).catch(function (err) {\n        console.log(\"GET ERR: \" + err); // console.log(\"URI: \" + process.env.MONGODB_URI);\n      }); // if (!this.state.exists) {\n      //     let body = {\n      //         email: this.state.user.email,\n      //         nickname: this.state.user.displayName\n      //     }\n      //     console.log(\"Body: \" + JSON.stringify(body));\n      //     axios.post(process.env.MONGODB_URI + '/api/createUser', body)\n      // }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: \"app\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"app__header\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }, this.state.user ? // <button>\n      //     Change Nickname\n      // </button>\n      // { this.doesUserExist.bind(this) }\n      React.createElement(\"h1\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138\n        },\n        __self: this\n      }, this.state.exists ? React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141\n        },\n        __self: this\n      }, this.state.callback ? React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143\n        },\n        __self: this\n      }, \"Welcome, \", React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143\n        },\n        __self: this\n      }, \" \", this.state.callback)) : React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147\n        },\n        __self: this\n      }, \"Welcome, \", React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147\n        },\n        __self: this\n      }, \" \", this.state.exists.nickname))) : React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      }, \"Welcome, \", React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      }, this.state.user.displayName))) : React.createElement(\"h1\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158\n        },\n        __self: this\n      }, \"CHAT SHROOMS\"), this.state.user ? // <button>\n      //     Change Nickname\n      // </button>\n      React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170\n        },\n        __self: this\n      }, React.createElement(Nickname, {\n        user: this.state.user,\n        nicknameCb: this.nickCb,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171\n        },\n        __self: this\n      })) : React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176\n        },\n        __self: this\n      })), this.state.user ? React.createElement(\"div\", {\n        className: \"app__list\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }, console.log(\"User to Form: \" + this.state.user.displayName), console.log(\"Email to Form: \" + this.state.user.email), console.log(\"Category: \" + this.state.category)) : React.createElement(\"span\", {\n        className: \"login-first\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      }, \"Please login first before proceeding with the chat\"), this.state.user ? React.createElement(\"div\", {\n        className: \"app__list\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196\n        },\n        __self: this\n      }, console.log(\"User to Form: \" + this.state.user.displayName), console.log(\"Email to Form: \" + this.state.user.email), console.log(\"Category: \" + this.state.category), React.createElement(\"span\", {\n        className: \"login-first\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200\n        },\n        __self: this\n      }, \"Please choose a category to proceed\"), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        className: \"app__button rounded \",\n        onClick: this.chooseCategory1.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202\n        },\n        __self: this\n      }, \"RANDOM\"), React.createElement(\"button\", {\n        className: \"app__button rounded \",\n        onClick: this.chooseCategory2.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208\n        },\n        __self: this\n      }, \"DISNEY\"), React.createElement(\"button\", {\n        className: \"app__button rounded \",\n        onClick: this.chooseCategory3.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214\n        },\n        __self: this\n      }, \"TV SERIES\"), React.createElement(\"button\", {\n        className: \"app__button rounded \",\n        onClick: this.chooseCategory4.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220\n        },\n        __self: this\n      }, \"GAMES\"))) : React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 229\n        },\n        __self: this\n      }), this.state.category && this.state.user ? React.createElement(\"div\", {\n        className: \"app__list\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 234\n        },\n        __self: this\n      }, console.log(\"User to Form: \" + this.state.user.displayName), console.log(\"Email to Form: \" + this.state.user.email), console.log(\"Category: \" + this.state.category), React.createElement(Form, {\n        user: this.state.user,\n        nickDb: this.state.exists,\n        dbdata: this.state.callback,\n        category: this.state.category,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 238\n        },\n        __self: this\n      })) : React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 241\n        },\n        __self: this\n      }), !this.state.user ? React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 246\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        className: \"app__button rounded \",\n        onClick: this.handleSignIn.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 246\n        },\n        __self: this\n      }, \"Sign in\")) : // this.context.router.push(\"./App/App\")\n      // <Router>\n      //     <Route exact path=\"/\">\n      //         {console.log(\"We were here\")}\n      //         {this.state.user ? <Redirect to=\"/App\" /> : <Main />}\n      // </Route>\n      React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 260\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        className: \"app__button rounded \",\n        onClick: this.handleLogOut.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 260\n        },\n        __self: this\n      }, \"Logout\")) // {/* </Router> */}\n      // <button\n      //     className=\"app__button rounded \"\n      //     onClick={this.handleLogOut.bind(this)}\n      // >\n      //     Logout\n      //     </button>\n      , React.createElement(Footer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 275\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return Main;\n}(Component);\n\nexport default Main;","map":{"version":3,"sources":["/Users/helengrace.delrosario/Desktop/BOOTCAMP/ACTIVITIES/WEEK23/PROJECT 3/Unsolved/client/src/components/Main/Main.js"],"names":["React","Component","Form","App","Nickname","Footer","firebase","firebaseConfig","axios","dotenv","BrowserRouter","Router","Route","Redirect","initializeApp","Main","props","nickCb","dataFromChild","setState","callback","state","user","category","exists","current","auth","onAuthStateChanged","doesUserExist","console","log","nickname","axiosUserExist","get","email","then","res","users","data","provider","GoogleAuthProvider","signInWithPopup","signOut","persons","body","displayName","JSON","stringify","post","catch","err","chooseCategory1","bind","chooseCategory2","chooseCategory3","chooseCategory4","handleSignIn","handleLogOut"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\n//import logo from '../../images/logo.svg';\nimport './Main.css';\nimport Form from '../Form/Form';\nimport App from '../App/App';\nimport Nickname from \"../Nickname/Nickname\";\nimport Footer from \"../Footer\";\nimport firebase from 'firebase';\nimport firebaseConfig from '../../config';\nimport axios from 'axios';\nimport dotenv from 'dotenv';\nimport { BrowserRouter as Router, Route, Redirect } from 'react-router-dom';\n\n\nfirebase.initializeApp(firebaseConfig);\nclass Main extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            user: null,\n            category: null,\n            exists: null,\n            current: null,\n            callback: null,\n        }\n    }\n\n    componentDidMount() {\n        firebase.auth().onAuthStateChanged(user => {\n            this.setState({ user: user });\n            this.doesUserExist();\n            // this.props.history.push('/path');\n        });\n    }\n\n    componentDidUpdate() {\n        // console.log(this.state.exists.nickname);\n        // console.log(this.state.user.nickname)\n        console.log(\"Component Did Update!\");\n        if (this.state.exists && this.state.current) {\n            if (this.state.exists.nickname != this.state.current.nickname) {\n                console.log(\"REEEEE: \" + this.state.exists.nickname);\n                console.log(\"REEEEE: \" + this.state.user.nickname)\n                this.axiosUserExist();\n            }\n        }\n    }\n\n    axiosUserExist() {\n        axios.get('/api/email/' //+ 'test1@gmail.com') \n            + this.state.user.email)\n            .then(res => {\n                const users = res.data;\n                console.log(\"success + \" + users);\n                this.setState({ current: users });\n            });\n    }\n\n    handleSignIn() {\n        const provider = new firebase.auth.GoogleAuthProvider();\n        firebase.auth().signInWithPopup(provider);\n    }\n\n    // renderRedirect = () => {\n    //     return <Redirect to=\"/App\" />\n    // }\n\n    handleLogOut() {\n        firebase.auth().signOut();\n    }\n\n    chooseCategory1() {\n        this.setState({ category: \"random\" });\n    }\n\n    chooseCategory2() {\n        this.setState({ category: \"disney\" });\n    }\n\n    chooseCategory3() {\n        this.setState({ category: \"tvseries\" });\n    }\n\n    chooseCategory4() {\n        this.setState({ category: \"games\" });\n    }\n\n    doesUserExist() {\n        console.log(\"doesUserExist - START\");\n        axios.get('/api/email/' //+ 'test1@gmail.com') \n            + this.state.user.email)\n            .then(res => {\n                const persons = res.data;\n                console.log(\"success + \" + persons);\n                this.setState({ exists: persons });\n\n                if (!persons) {\n                    let body = {\n                        email: this.state.user.email,\n                        nickname: this.state.user.displayName\n                    }\n                    console.log(\"Body: \" + JSON.stringify(body));\n                    axios.post('/api/createUser', body)\n                }\n                console.log(\"Exists: \" + this.state.exists);\n            }).catch(err => {\n                console.log(\"GET ERR: \" + err);\n                // console.log(\"URI: \" + process.env.MONGODB_URI);\n            });\n\n\n        // if (!this.state.exists) {\n        //     let body = {\n        //         email: this.state.user.email,\n        //         nickname: this.state.user.displayName\n        //     }\n        //     console.log(\"Body: \" + JSON.stringify(body));\n        //     axios.post(process.env.MONGODB_URI + '/api/createUser', body)\n        // }\n    }\n\n    nickCb = (dataFromChild) => {\n        this.setState({ callback: dataFromChild });\n    }\n\n    render() {\n        return (\n            <div className=\"app\">\n                <div className=\"app__header\">\n                    {/* <img src={logo} className=\"app__logo\" alt=\"logo\" /> */}\n                    {this.state.user ? (\n                        // <button>\n                        //     Change Nickname\n                        // </button>\n                        // { this.doesUserExist.bind(this) }\n\n\n                        < h1>\n                            {\n                                this.state.exists ? (\n                                    <span>{\n                                        this.state.callback ? (\n                                            <div>Welcome, < span > {this.state.callback}</span></div>\n                                        ) :\n                                            (\n\n                                                <div>Welcome, < span > {this.state.exists.nickname}</span></div>\n                                            )\n                                    }</span>\n\n\n                                ) : (<div>Welcome, <span>{this.state.user.displayName}</span></div>)\n                            }\n\n                        </h1>\n\n                    ) : (\n                            <h1>\n                                CHAT SHROOMS\n                            </h1>\n                        )\n                    }\n\n\n                    {\n                        this.state.user ? (\n                            // <button>\n                            //     Change Nickname\n                            // </button>\n                            <div>\n                                <Nickname user={this.state.user} nicknameCb={this.nickCb} />\n\n                            </div>\n\n                        ) : (\n                                <div></div>\n                            )\n                    }\n\n\n\n                </div >\n                {\n                    this.state.user ? (\n                        <div className=\"app__list\">\n                            {console.log(\"User to Form: \" + this.state.user.displayName)}\n                            {console.log(\"Email to Form: \" + this.state.user.email)}\n                            {console.log(\"Category: \" + this.state.category)}\n                        </div>\n                    ) : (\n                            <span className=\"login-first\">Please login first before proceeding with the chat</span>\n                        )\n                }\n                {\n                    this.state.user ? (\n                        <div className=\"app__list\">\n                            {console.log(\"User to Form: \" + this.state.user.displayName)}\n                            {console.log(\"Email to Form: \" + this.state.user.email)}\n                            {console.log(\"Category: \" + this.state.category)}\n                            <span className=\"login-first\">Please choose a category to proceed</span>\n                            <div>\n                                <button\n                                    className=\"app__button rounded \"\n                                    onClick={this.chooseCategory1.bind(this)}\n                                >\n                                    RANDOM\n                                </button>\n                                <button\n                                    className=\"app__button rounded \"\n                                    onClick={this.chooseCategory2.bind(this)}\n                                >\n                                    DISNEY\n                                </button>\n                                <button\n                                    className=\"app__button rounded \"\n                                    onClick={this.chooseCategory3.bind(this)}\n                                >\n                                    TV SERIES\n                                </button>\n                                <button\n                                    className=\"app__button rounded \"\n                                    onClick={this.chooseCategory4.bind(this)}\n                                >\n                                    GAMES\n                                </button>\n                            </div>\n                        </div>\n                    ) : (\n                            <div></div>\n                        )\n                }\n                {\n                    this.state.category && this.state.user ? (\n                        <div className=\"app__list\">\n                            {console.log(\"User to Form: \" + this.state.user.displayName)}\n                            {console.log(\"Email to Form: \" + this.state.user.email)}\n                            {console.log(\"Category: \" + this.state.category)}\n                            <Form user={this.state.user} nickDb={this.state.exists} dbdata={this.state.callback} category={this.state.category} />\n                        </div>\n                    ) : (\n                            <div></div>\n                        )\n                }\n                {\n                    !this.state.user ? (\n                        <div><button\n                            className=\"app__button rounded \"\n                            onClick={this.handleSignIn.bind(this)}\n                        >\n                            Sign in\n                            </button></div>\n                    ) : (\n                            // this.context.router.push(\"./App/App\")\n\n                            // <Router>\n                            //     <Route exact path=\"/\">\n                            //         {console.log(\"We were here\")}\n                            //         {this.state.user ? <Redirect to=\"/App\" /> : <Main />}\n                            // </Route>\n                            <div><button\n                                className=\"app__button rounded \"\n                                onClick={this.handleLogOut.bind(this)}\n                            >\n                                Logout\n                                </button></div>\n                            // {/* </Router> */}\n                            // <button\n                            //     className=\"app__button rounded \"\n                            //     onClick={this.handleLogOut.bind(this)}\n                            // >\n                            //     Logout\n                            //     </button>\n                        )\n                }\n                <Footer />\n            </div >\n        );\n    }\n}\nexport default Main;"]},"metadata":{},"sourceType":"module"}