{"ast":null,"code":"import _classCallCheck from \"/Users/helengrace.delrosario/Desktop/BOOTCAMP/ACTIVITIES/WEEK24/PROJECT 3/chat-shrooms-project/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/helengrace.delrosario/Desktop/BOOTCAMP/ACTIVITIES/WEEK24/PROJECT 3/chat-shrooms-project/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/helengrace.delrosario/Desktop/BOOTCAMP/ACTIVITIES/WEEK24/PROJECT 3/chat-shrooms-project/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/helengrace.delrosario/Desktop/BOOTCAMP/ACTIVITIES/WEEK24/PROJECT 3/chat-shrooms-project/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/helengrace.delrosario/Desktop/BOOTCAMP/ACTIVITIES/WEEK24/PROJECT 3/chat-shrooms-project/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/helengrace.delrosario/Desktop/BOOTCAMP/ACTIVITIES/WEEK24/PROJECT 3/chat-shrooms-project/client/src/components/Main/Main.js\";\nimport React, { Component } from 'react';\nimport img from '../../img/tt.png';\nimport './Main.css';\nimport Form from '../Form/Form';\nimport App from '../App/App';\nimport Nickname from \"../Nickname/Nickname\";\nimport Footer from \"../Footer\";\nimport firebase from 'firebase';\nimport firebaseConfig from '../../config';\nimport axios from 'axios';\nimport dotenv from 'dotenv';\nimport { BrowserRouter as Router, Route, Redirect } from 'react-router-dom';\nfirebase.initializeApp(firebaseConfig);\n\nvar Main =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Main, _Component);\n\n  function Main(props) {\n    var _this;\n\n    _classCallCheck(this, Main);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Main).call(this, props));\n\n    _this.nickCb = function (dataFromChild, email) {\n      _this.setState({\n        callback: dataFromChild\n      });\n\n      _this.setState({\n        callbackemail: email\n      });\n\n      console.log(\"EMAIIIIIILLLL : \" + email);\n    };\n\n    _this.state = {\n      user: null,\n      category: null,\n      exists: null,\n      current: null,\n      callback: null,\n      callbackemail: null,\n      allUsers: null\n    };\n    return _this;\n  }\n\n  _createClass(Main, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      firebase.auth().onAuthStateChanged(function (user) {\n        _this2.setState({\n          user: user\n        });\n\n        _this2.doesUserExist();\n\n        _this2.getAllUsers(); // this.props.history.push('/path');\n\n      });\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      // console.log(this.state.exists.nickname);\n      // console.log(this.state.user.nickname)\n      console.log(\"Component Did Update!\");\n\n      if (this.state.exists && this.state.current) {\n        if (this.state.exists.nickname != this.state.current.nickname) {\n          console.log(\"REEEEE: \" + this.state.exists.nickname);\n          console.log(\"REEEEE: \" + this.state.user.nickname);\n          this.axiosUserExist();\n        }\n      }\n    }\n  }, {\n    key: \"axiosUserExist\",\n    value: function axiosUserExist() {\n      var _this3 = this;\n\n      axios.get('/api/email/' //+ 'test1@gmail.com') \n      + this.state.user.email).then(function (res) {\n        var users = res.data;\n        console.log(\"success + \" + users);\n\n        _this3.setState({\n          current: users\n        });\n      });\n    }\n  }, {\n    key: \"handleSignIn\",\n    value: function handleSignIn() {\n      var provider = new firebase.auth.GoogleAuthProvider();\n      firebase.auth().signInWithPopup(provider);\n    }\n  }, {\n    key: \"handleLogOut\",\n    value: function handleLogOut() {\n      firebase.auth().signOut();\n    } // chooseCategory1() {\n    //     this.setState({ category: \"random\" });\n    // }\n    // chooseCategory2() {\n    //     this.setState({ category: \"disney\" });\n    // }\n    // chooseCategory3() {\n    //     this.setState({ category: \"tvseries\" });\n    // }\n    // chooseCategory4() {\n    //     this.setState({ category: \"games\" });\n    // }\n\n  }, {\n    key: \"randomCategory\",\n    value: function randomCategory() {\n      var intRand = Math.floor(Math.random() * 3) + 1;\n\n      if (intRand == 1) {\n        this.setState({\n          category: \"tvseries\"\n        });\n      } else if (intRand == 2) {\n        this.setState({\n          category: \"games\"\n        });\n      } else {\n        this.setState({\n          category: \"random\"\n        });\n      }\n    }\n  }, {\n    key: \"doesUserExist\",\n    value: function doesUserExist() {\n      var _this4 = this;\n\n      console.log(\"doesUserExist - START\");\n      axios.get('/api/email/' //+ 'test1@gmail.com') \n      + this.state.user.email).then(function (res) {\n        var persons = res.data;\n        console.log(\"success + \" + persons);\n\n        _this4.setState({\n          exists: persons\n        });\n\n        if (!persons) {\n          var body = {\n            email: _this4.state.user.email,\n            nickname: _this4.state.user.displayName\n          };\n          console.log(\"Body: \" + JSON.stringify(body));\n          axios.post('/api/createUser', body);\n        }\n\n        console.log(\"Exists: \" + _this4.state.exists);\n      }).catch(function (err) {\n        console.log(\"GET ERR: \" + err); // console.log(\"URI: \" + process.env.MONGODB_URI);\n      });\n    }\n  }, {\n    key: \"getAllUsers\",\n    value: function getAllUsers() {\n      var _this5 = this;\n\n      axios.get('/api/all/').then(function (res) {\n        console.log(\"USERS: \" + JSON.stringify(res.data));\n\n        _this5.setState({\n          allUsers: res.data\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: \"main\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"main-header\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        src: img,\n        className: \"main-logo\",\n        alt: \"logo\",\n        \"data-aos\": \"flip-down\",\n        \"data-aos-once\": \"false\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141\n        },\n        __self: this\n      }), this.state.user ? // <button>\n      //     Change Nickname\n      // </button>\n      // { this.doesUserExist.bind(this) }\n      React.createElement(\"h1\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149\n        },\n        __self: this\n      }, this.state.exists ? React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      }, this.state.callback ? React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154\n        },\n        __self: this\n      }, \"Welcome, \", React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154\n        },\n        __self: this\n      }, \" \", this.state.callback)) : React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158\n        },\n        __self: this\n      }, \"Welcome, \", React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158\n        },\n        __self: this\n      }, \" \", this.state.exists.nickname))) : React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163\n        },\n        __self: this\n      }, \"Welcome, \", React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163\n        },\n        __self: this\n      }, this.state.user.displayName))) : React.createElement(\"h1\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169\n        },\n        __self: this\n      }, \"CHAT SHROOMS\"), this.state.user ? // <button>\n      //     Change Nickname\n      // </button>\n      // <div>\n      React.createElement(Nickname, {\n        user: this.state.user,\n        nicknameCb: this.nickCb,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182\n        },\n        __self: this\n      }) // </div>\n      : React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187\n        },\n        __self: this\n      })), this.state.user ? React.createElement(\"div\", {\n        className: \"main-list\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196\n        },\n        __self: this\n      }, console.log(\"USER LOGGING IN : \" + this.state.user.displayName)) : React.createElement(\"span\", {\n        className: \"login-first\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200\n        },\n        __self: this\n      }, \"Please login first before proceeding with the chat\"), this.state.user ? React.createElement(\"div\", {\n        className: \"main-list\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205\n        },\n        __self: this\n      }, console.log(\"User to Form: \" + this.state.user.displayName), console.log(\"Email to Form: \" + this.state.user.email), console.log(\"Category: \" + this.state.category), React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 209\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"login-first\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 209\n        },\n        __self: this\n      }, \"Click to get a random shroom!\")), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        className: \"main-button\",\n        onClick: this.randomCategory.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 211\n        },\n        __self: this\n      }, \"RANDOM\"))) : React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 245\n        },\n        __self: this\n      }), this.state.category && this.state.user ? React.createElement(\"div\", {\n        className: \"main-list\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 250\n        },\n        __self: this\n      }, console.log(\"User to Form: \" + this.state.user.displayName), console.log(\"Email to Form: \" + this.state.user.email), console.log(\"Category: \" + this.state.category), console.log(\"Callback: \" + this.state.callback), React.createElement(Form, {\n        user: this.state.user,\n        allUsers: this.state.allUsers,\n        nickDb: this.state.exists,\n        dbdata: this.state.callback,\n        dbemail: this.state.callbackemail,\n        category: this.state.category,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 255\n        },\n        __self: this\n      })) : React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 258\n        },\n        __self: this\n      }), !this.state.user ? React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 263\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        className: \"signin-button rounded \",\n        onClick: this.handleSignIn.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 263\n        },\n        __self: this\n      }, \"Sign in\")) : // this.context.router.push(\"./App/App\")\n      // <Router>\n      //     <Route exact path=\"/\">\n      //         {console.log(\"We were here\")}\n      //         {this.state.user ? <Redirect to=\"/App\" /> : <Main />}\n      // </Route>\n      React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 277\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        className: \"logout-button rounded \",\n        onClick: this.handleLogOut.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 278\n        },\n        __self: this\n      }, \"Logout\")) // {/* </Router> */}\n      // <button\n      //     className=\"main-button rounded \"\n      //     onClick={this.handleLogOut.bind(this)}\n      // >\n      //     Logout\n      //     </button>\n      , React.createElement(Footer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 294\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return Main;\n}(Component);\n\nexport default Main;","map":{"version":3,"sources":["/Users/helengrace.delrosario/Desktop/BOOTCAMP/ACTIVITIES/WEEK24/PROJECT 3/chat-shrooms-project/client/src/components/Main/Main.js"],"names":["React","Component","img","Form","App","Nickname","Footer","firebase","firebaseConfig","axios","dotenv","BrowserRouter","Router","Route","Redirect","initializeApp","Main","props","nickCb","dataFromChild","email","setState","callback","callbackemail","console","log","state","user","category","exists","current","allUsers","auth","onAuthStateChanged","doesUserExist","getAllUsers","nickname","axiosUserExist","get","then","res","users","data","provider","GoogleAuthProvider","signInWithPopup","signOut","intRand","Math","floor","random","persons","body","displayName","JSON","stringify","post","catch","err","randomCategory","bind","handleSignIn","handleLogOut"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport img from '../../img/tt.png';\nimport './Main.css';\nimport Form from '../Form/Form';\nimport App from '../App/App';\nimport Nickname from \"../Nickname/Nickname\";\nimport Footer from \"../Footer\";\nimport firebase from 'firebase';\nimport firebaseConfig from '../../config';\nimport axios from 'axios';\nimport dotenv from 'dotenv';\nimport { BrowserRouter as Router, Route, Redirect } from 'react-router-dom';\n\n\nfirebase.initializeApp(firebaseConfig);\nclass Main extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            user: null,\n            category: null,\n            exists: null,\n            current: null,\n            callback: null,\n            callbackemail: null,\n            allUsers: null,\n        }\n    }\n\n    componentDidMount() {\n        firebase.auth().onAuthStateChanged(user => {\n            this.setState({ user: user });\n            this.doesUserExist();\n            this.getAllUsers();\n            // this.props.history.push('/path');\n        });\n    }\n\n    componentDidUpdate() {\n        // console.log(this.state.exists.nickname);\n        // console.log(this.state.user.nickname)\n        console.log(\"Component Did Update!\");\n        if (this.state.exists && this.state.current) {\n            if (this.state.exists.nickname != this.state.current.nickname) {\n                console.log(\"REEEEE: \" + this.state.exists.nickname);\n                console.log(\"REEEEE: \" + this.state.user.nickname)\n                this.axiosUserExist();\n            }\n        }\n    }\n\n    axiosUserExist() {\n        axios.get('/api/email/' //+ 'test1@gmail.com') \n            + this.state.user.email)\n            .then(res => {\n                const users = res.data;\n                console.log(\"success + \" + users);\n                this.setState({ current: users });\n            });\n    }\n\n    handleSignIn() {\n        const provider = new firebase.auth.GoogleAuthProvider();\n        firebase.auth().signInWithPopup(provider);\n    }\n\n    handleLogOut() {\n        firebase.auth().signOut();\n    }\n\n    // chooseCategory1() {\n    //     this.setState({ category: \"random\" });\n    // }\n\n    // chooseCategory2() {\n    //     this.setState({ category: \"disney\" });\n    // }\n\n    // chooseCategory3() {\n    //     this.setState({ category: \"tvseries\" });\n    // }\n\n    // chooseCategory4() {\n    //     this.setState({ category: \"games\" });\n    // }\n\n    randomCategory() {\n        let intRand = (Math.floor(Math.random() * 3) + 1);\n        if (intRand == 1) {\n            this.setState({ category: \"tvseries\" });\n        } else if (intRand == 2) {\n            this.setState({ category: \"games\" });\n        } else {\n            this.setState({ category: \"random\" });\n        }\n    }\n\n    doesUserExist() {\n        console.log(\"doesUserExist - START\");\n        axios.get('/api/email/' //+ 'test1@gmail.com') \n            + this.state.user.email)\n            .then(res => {\n                const persons = res.data;\n                console.log(\"success + \" + persons);\n                this.setState({ exists: persons });\n\n                if (!persons) {\n                    let body = {\n                        email: this.state.user.email,\n                        nickname: this.state.user.displayName\n                    }\n                    console.log(\"Body: \" + JSON.stringify(body));\n                    axios.post('/api/createUser', body)\n                }\n                console.log(\"Exists: \" + this.state.exists);\n            }).catch(err => {\n                console.log(\"GET ERR: \" + err);\n                // console.log(\"URI: \" + process.env.MONGODB_URI);\n            });\n\n    }\n\n    getAllUsers() {\n        axios.get('/api/all/')\n            .then(res => {\n                console.log(\"USERS: \" + JSON.stringify(res.data));\n                this.setState({ allUsers: res.data });\n            });\n    }\n\n    nickCb = (dataFromChild, email) => {\n        this.setState({ callback: dataFromChild });\n        this.setState({ callbackemail: email });\n        console.log(\"EMAIIIIIILLLL : \" + email);\n    }\n\n    render() {\n        return (\n            <div className=\"main\">\n                <div className=\"main-header\">\n                    <img src={img} className=\"main-logo\" alt=\"logo\" data-aos=\"flip-down\" data-aos-once=\"false\" />\n                    {this.state.user ? (\n                        // <button>\n                        //     Change Nickname\n                        // </button>\n                        // { this.doesUserExist.bind(this) }\n\n\n                        < h1>\n                            {\n                                this.state.exists ? (\n                                    <span>{\n                                        this.state.callback ? (\n                                            <div>Welcome, < span > {this.state.callback}</span></div>\n                                        ) :\n                                            (\n\n                                                <div>Welcome, < span > {this.state.exists.nickname}</span></div>\n                                            )\n                                    }</span>\n\n\n                                ) : (<div>Welcome, <span>{this.state.user.displayName}</span></div>)\n                            }\n\n                        </h1>\n\n                    ) : (\n                            <h1>\n                                CHAT SHROOMS\n                            </h1>\n                        )\n                    }\n\n\n                    {\n                        this.state.user ? (\n                            // <button>\n                            //     Change Nickname\n                            // </button>\n                            // <div>\n                            <Nickname user={this.state.user} nicknameCb={this.nickCb} />\n\n                            // </div>\n\n                        ) : (\n                                <div></div>\n                            )\n                    }\n\n\n\n                </div >\n                {\n                    this.state.user ? (\n                        <div className=\"main-list\">\n                            {console.log(\"USER LOGGING IN : \" + this.state.user.displayName)}\n                        </div>\n                    ) : (\n                            <span className=\"login-first\">Please login first before proceeding with the chat</span>\n                        )\n                }\n                {\n                    this.state.user ? (\n                        <div className=\"main-list\">\n                            {console.log(\"User to Form: \" + this.state.user.displayName)}\n                            {console.log(\"Email to Form: \" + this.state.user.email)}\n                            {console.log(\"Category: \" + this.state.category)}\n                            <h2><span className=\"login-first\">Click to get a random shroom!</span></h2>\n                            <div>\n                                <button\n                                    className=\"main-button\"\n                                    onClick={this.randomCategory.bind(this)}\n                                >\n                                    RANDOM\n                                </button>\n\n                                {/* <button\n                                    className=\"main-button rounded \"\n                                    onClick={this.chooseCategory1.bind(this)}\n                                >\n                                    RANDOM\n                                </button> */}\n                                {/* <button\n                                    className=\"main-button rounded \"\n                                    onClick={this.chooseCategory2.bind(this)}\n                                >\n                                    DISNEY\n                                </button> */}\n                                {/* <button\n                                    className=\"main-button rounded \"\n                                    onClick={this.chooseCategory3.bind(this)}\n                                >\n                                    TV SERIES\n                                </button>\n                                <button\n                                    className=\"main-button rounded \"\n                                    onClick={this.chooseCategory4.bind(this)}\n                                >\n                                    GAMES\n                                </button> */}\n                            </div>\n                        </div>\n                    ) : (\n                            <div></div>\n                        )\n                }\n                {\n                    this.state.category && this.state.user ? (\n                        <div className=\"main-list\">\n                            {console.log(\"User to Form: \" + this.state.user.displayName)}\n                            {console.log(\"Email to Form: \" + this.state.user.email)}\n                            {console.log(\"Category: \" + this.state.category)}\n                            {console.log(\"Callback: \" + this.state.callback)}\n                            <Form user={this.state.user} allUsers={this.state.allUsers} nickDb={this.state.exists} dbdata={this.state.callback} dbemail={this.state.callbackemail} category={this.state.category} />\n                        </div>\n                    ) : (\n                            <div></div>\n                        )\n                }\n                {\n                    !this.state.user ? (\n                        <div><button\n                            className=\"signin-button rounded \"\n                            onClick={this.handleSignIn.bind(this)}\n                        >\n                            Sign in\n                            </button></div>\n                    ) : (\n                            // this.context.router.push(\"./App/App\")\n\n                            // <Router>\n                            //     <Route exact path=\"/\">\n                            //         {console.log(\"We were here\")}\n                            //         {this.state.user ? <Redirect to=\"/App\" /> : <Main />}\n                            // </Route>\n                            <div>\n                                <button\n                                    className=\"logout-button rounded \"\n                                    onClick={this.handleLogOut.bind(this)}\n                                >\n                                    Logout\n                                </button>\n                            </div>\n                            // {/* </Router> */}\n                            // <button\n                            //     className=\"main-button rounded \"\n                            //     onClick={this.handleLogOut.bind(this)}\n                            // >\n                            //     Logout\n                            //     </button>\n                        )\n                }\n                <Footer />\n            </div >\n        );\n    }\n}\nexport default Main;"]},"metadata":{},"sourceType":"module"}